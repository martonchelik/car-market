# Car Market

Интернет-площадка для продажи и покупки автомобилей.

## Устранение проблем с аутентификацией

Если вы столкнулись с ошибками при регистрации пользователей или входе в систему, выполните следующие шаги:

### 1. Фиксация поля пароля в базе данных

В MySQL схеме поле пароля имеет ограничение VARCHAR(45), что недостаточно для хранения bcrypt-хешей. Выполните следующую команду для исправления поля:

```bash
npm run db:fix-password
```

Или напрямую в MySQL:

```sql
ALTER TABLE users MODIFY COLUMN password VARCHAR(255) NOT NULL;
```

### 2. Исправление совместимости паролей

Обновленная система аутентификации теперь поддерживает:
- Вход с использованием нехешированных паролей из существующей базы данных
- Автоматическую миграцию на bcrypt-хеши при первом входе
- Регистрацию с использованием безопасных bcrypt-хешей

### 3. Ручное обновление паролей

Чтобы вручную обновить хеши паролей для всех пользователей, выполните следующие шаги:

1. Создайте резервную копию базы данных
2. Запустите скрипт миграции
3. Для тестирования используйте тестовые учетные записи из SQL скрипта

## Запуск приложения

### Установка зависимостей

```bash
npm install
# или
bun install
```

### Запуск в режиме разработки

```bash
npm run dev
# или
bun run dev
```

### Сборка для production

```bash
npm run build
# или
bun run build
```

### Запуск production-версии

```bash
npm run start
# или
bun run start
```

## Документация

### База данных

Приложение использует MySQL базу данных. Схема базы данных находится в директории `sql/schema.sql`.

### API

Приложение предоставляет следующие API endpoint'ы:

- `/api/auth/register` - регистрация пользователя
- `/api/auth/[...nextauth]` - аутентификация через NextAuth

## Технологии

- Next.js
- Prisma
- NextAuth.js
- MySQL
